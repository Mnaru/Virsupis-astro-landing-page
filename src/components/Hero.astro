---
interface Props {
  image: string;
  alt?: string;
}

const { image, alt = "" } = Astro.props;
---

<section class="hero">
  <img id="hero-image" src={image} alt={alt} class="hero-image" loading="eager" fetchpriority="high" />
</section>

<!-- Spacer to push content below fixed hero -->
<div id="hero-spacer" class="hero-spacer"></div>

<style>
  .hero {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 850px;
    overflow: hidden;
    z-index: 1;
    background-color: #000; /* Black background revealed as image fades */
  }

  .hero-image {
    width: 100%;
    height: 100%;
    object-fit: cover;
    object-position: center;
    transform-origin: center center;
    /* Initial state - GSAP will animate opacity and scale */
  }

  .hero-spacer {
    height: 850px;
    position: relative;
    z-index: 1;
  }
</style>

<script>
  import { gsap } from "gsap";
  import { ScrollTrigger } from "gsap/ScrollTrigger";

  gsap.registerPlugin(ScrollTrigger);

  const heroImage = document.getElementById("hero-image");
  const heroSpacer = document.getElementById("hero-spacer");

  if (heroImage && heroSpacer) {
    // Create scroll-linked animation for hero effects
    gsap.fromTo(
      heroImage,
      {
        opacity: 1,
        scale: 1,
      },
      {
        opacity: 0.3,
        scale: 0.95,
        ease: "none",
        scrollTrigger: {
          trigger: heroSpacer,
          start: "top top", // Start when spacer top reaches viewport top
          end: "bottom top", // End when spacer bottom reaches viewport top (hero fully covered)
          scrub: 0.5, // Smooth scrubbing
        },
      }
    );
  }
</script>
